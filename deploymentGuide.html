<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>AWS Deployment Guide | APCSP</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="AWS Deployment Guide" />
<meta name="author" content="Ethan Tran, Samit Poojary, and Azeem Khan" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="This notebook will guide you step-by-step on how to configure your AWS instance and docker container in order to deploy your backend. Thank you to Azeem Khan, Samit Poojary, Ethan Tran, Sophie Park, Edwin Abraham, Mr. Mortensen and Jeffrey Fonseca for resources and instructions." />
<meta property="og:description" content="This notebook will guide you step-by-step on how to configure your AWS instance and docker container in order to deploy your backend. Thank you to Azeem Khan, Samit Poojary, Ethan Tran, Sophie Park, Edwin Abraham, Mr. Mortensen and Jeffrey Fonseca for resources and instructions." />
<link rel="canonical" href="https://nighthawkcoders.github.io/APCSP/deploymentGuide" />
<meta property="og:url" content="https://nighthawkcoders.github.io/APCSP/deploymentGuide" />
<meta property="og:site_name" content="APCSP" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-02-20T00:00:00-06:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="AWS Deployment Guide" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Ethan Tran, Samit Poojary, and Azeem Khan"},"dateModified":"2023-02-20T00:00:00-06:00","datePublished":"2023-02-20T00:00:00-06:00","description":"This notebook will guide you step-by-step on how to configure your AWS instance and docker container in order to deploy your backend. Thank you to Azeem Khan, Samit Poojary, Ethan Tran, Sophie Park, Edwin Abraham, Mr. Mortensen and Jeffrey Fonseca for resources and instructions.","headline":"AWS Deployment Guide","mainEntityOfPage":{"@type":"WebPage","@id":"https://nighthawkcoders.github.io/APCSP/deploymentGuide"},"url":"https://nighthawkcoders.github.io/APCSP/deploymentGuide"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/APCSP/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://nighthawkcoders.github.io/APCSP/feed.xml" title="APCSP" /><link rel="shortcut icon" type="image/x-icon" href="/APCSP/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/APCSP/">APCSP</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/APCSP/schedule">Schedule</a><a class="page-link" href="/APCSP/frontend/overview">Frontend</a><a class="page-link" href="/APCSP/api/overview">API</a><a class="page-link" href="/APCSP/search/">Search</a><a class="page-link" href="/APCSP/categories/ap">AP Standards</a><a class="page-link" href="/APCSP/categories/cte">CTE Standards</a><a class="page-link" href="/APCSP/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">AWS Deployment Guide</h1><p class="page-description">This notebook will guide you step-by-step on how to configure your AWS instance and docker container in order to deploy your backend. Thank you to Azeem Khan, Samit Poojary, Ethan Tran, Sophie Park, Edwin Abraham, Mr. Mortensen and Jeffrey Fonseca for resources and instructions.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2023-02-20T00:00:00-06:00" itemprop="datePublished">
        Feb 20, 2023
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">Ethan Tran, Samit Poojary, and Azeem Khan</span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      11 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
          <a class="category-tags-link" href="/APCSP/categories/ap#6.B">6.B</a>
        
        &nbsp;
      
          <a class="category-tags-link" href="/APCSP/categories/cte#C7.0">C7.0</a>
        
        &nbsp;
      
          <a class="category-tags-link" href="/APCSP/categories/cte#C7.1">C7.1</a>
        
        &nbsp;
      
          <a class="category-tags-link" href="/APCSP/categories/cte#C7.2">C7.2</a>
        
        
      
      </p>
    

    
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul id="toc" class="section-nav">
<li class="toc-entry toc-h2"><a href="#Prerequisites">Prerequisites </a></li>
<li class="toc-entry toc-h2"><a href="#Accessing-AWS-EC2">Accessing AWS EC2 </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Amazon-Web-Services-(AWS)-Management-Console">Amazon Web Services (AWS) Management Console </a></li>
<li class="toc-entry toc-h3"><a href="#Unrestricted-Gateway-to-AWS-EC2-Terminal">Unrestricted Gateway to AWS EC2 Terminal </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Local-Setup">Local Setup </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Finding-a-Port">Finding a Port </a></li>
<li class="toc-entry toc-h3"><a href="#Setting-up-Docker-using-VSCode">Setting up Docker using VSCode </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#AWS-Setup">AWS Setup </a></li>
<li class="toc-entry toc-h2"><a href="#DNS-&-NGINX-Setup">DNS &amp; NGINX Setup </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Nginx-setup-in-AWS-terminal">Nginx setup in AWS terminal </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Certbot-Config">Certbot Config </a></li>
<li class="toc-entry toc-h2"><a href="#Changing-Code-will-require-Deployment-Updates">Changing Code will require Deployment Updates </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Changing-Code-in-VSCode">Changing Code in VSCode </a></li>
<li class="toc-entry toc-h3"><a href="#Pulling-Changes-into-AWS-EC2-deployment">Pulling Changes into AWS EC2 deployment </a></li>
<li class="toc-entry toc-h3"><a href="#Optional,-Troubleshooting-checks-on-AWS-EC2">Optional, Troubleshooting checks on AWS EC2 </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Congratulations!">Congratulations! </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2023-02-20-deploymentGuide.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Prerequisites">
<a class="anchor" href="#Prerequisites" aria-hidden="true"><span class="octicon octicon-link"></span></a>Prerequisites<a class="anchor-link" href="#Prerequisites"> </a>
</h2>
<blockquote>
<p>Fullfil these requirements prior to moving forward in this guide.</p>
<ol>
<li>Must have a backend repository on GitHub.</li>
<li>Verify <strong>Backend is running on localhost</strong>. If it doesn't run on localhost, then it won't run on the deployment server!!!</li>
<li>You must have a configured Domain Name pointing to the Public IP of your deployment server.  See <a href="https://moonpiedumplings.github.io/quartotest/posts/duckdns">Duck DNS Guide</a> for a guide on how to do this.​</li>
</ol>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Accessing-AWS-EC2">
<a class="anchor" href="#Accessing-AWS-EC2" aria-hidden="true"><span class="octicon octicon-link"></span></a>Accessing AWS EC2<a class="anchor-link" href="#Accessing-AWS-EC2"> </a>
</h2>
<blockquote>
<p>Development Operations (DevOps) requires server access.</p>
</blockquote>
<h3 id="Amazon-Web-Services-(AWS)-Management-Console">
<a class="anchor" href="#Amazon-Web-Services-(AWS)-Management-Console" aria-hidden="true"><span class="octicon octicon-link"></span></a>Amazon Web Services (AWS) Management Console<a class="anchor-link" href="#Amazon-Web-Services-(AWS)-Management-Console"> </a>
</h3>
<ul>
<li>Login to AWS Console using your account.  Navigate to "EC2" and the "Instances" dropdown.</li>
</ul>
<p><img src="/APCSP/images/copied_from_nb/images/EC2.png" alt="EC2 Screenshot"></p>
<ul>
<li>From here, a variety of instances will show up. For this project, depending on which teacher you have, select either "NCS.cf Yeung CSP" or "NCS.gq Mort CSP"</li>
</ul>
<p><img src="/APCSP/images/copied_from_nb/images/instancesAWS.png" alt="AWS Instances Screenshot"></p>
<h3 id="Unrestricted-Gateway-to-AWS-EC2-Terminal">
<a class="anchor" href="#Unrestricted-Gateway-to-AWS-EC2-Terminal" aria-hidden="true"><span class="octicon octicon-link"></span></a>Unrestricted Gateway to AWS EC2 Terminal<a class="anchor-link" href="#Unrestricted-Gateway-to-AWS-EC2-Terminal"> </a>
</h3>
<blockquote>
<p>At school access theway.nighthawkcodingsociety.com and log in.  Follow the prompt to go to your appropriate server. (ex. type in <code>gocf</code> or <code>gogq</code> to match your Teachers server).</p>

<pre><code>- Username is `ubuntu`. Password hint is 3 Musketeers</code></pre>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Local-Setup">
<a class="anchor" href="#Local-Setup" aria-hidden="true"><span class="octicon octicon-link"></span></a>Local Setup<a class="anchor-link" href="#Local-Setup"> </a>
</h2>
<h3 id="Finding-a-Port">
<a class="anchor" href="#Finding-a-Port" aria-hidden="true"><span class="octicon octicon-link"></span></a>Finding a Port<a class="anchor-link" href="#Finding-a-Port"> </a>
</h3>
<p>In AWS EC2;</p>
<ol>
<li>Run <code>docker ps</code> review list and find a port number starting in 8--- that is not in use. Valid ports are between 1024-49150, but we are asking that you stick to 8---.</li>
</ol>
<h3 id="Setting-up-Docker-using-VSCode">
<a class="anchor" href="#Setting-up-Docker-using-VSCode" aria-hidden="true"><span class="octicon octicon-link"></span></a>Setting up Docker using VSCode<a class="anchor-link" href="#Setting-up-Docker-using-VSCode"> </a>
</h3>
<ol>
<li>
<p>Open VSCode and navigate to your Flask repository (backend)</p>
</li>
<li>
<p>Make sure your <code>Dockerfile</code> matches the template below.</p>
</li>
</ol>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">FROM</span> <span class="n">docker</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">python</span><span class="p">:</span><span class="mf">3.10</span>

<span class="n">WORKDIR</span> <span class="o">/</span>

<span class="c1"># --- [Install python and pip] ---</span>
<span class="n">RUN</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">update</span> <span class="o">&amp;&amp;</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">upgrade</span> <span class="o">-</span><span class="n">y</span> <span class="o">&amp;&amp;</span> \
    <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="n">python3</span> <span class="n">python3</span><span class="o">-</span><span class="n">pip</span> <span class="n">git</span>
<span class="n">COPY</span> <span class="o">.</span> <span class="o">/</span>

<span class="n">RUN</span> <span class="n">pip</span> <span class="n">install</span> <span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">cache</span><span class="o">-</span><span class="nb">dir</span> <span class="o">-</span><span class="n">r</span> <span class="n">requirements</span><span class="o">.</span><span class="n">txt</span>
<span class="n">RUN</span> <span class="n">pip</span> <span class="n">install</span> <span class="n">gunicorn</span>

<span class="n">ENV</span> <span class="n">GUNICORN_CMD_ARGS</span><span class="o">=</span><span class="s2">"--workers=3 --bind=0.0.0.0:8080"</span>

<span class="n">EXPOSE</span> <span class="mi">8080</span>

<span class="n">CMD</span> <span class="p">[</span> <span class="s2">"gunicorn"</span><span class="p">,</span> <span class="s2">"main:app"</span> <span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ol>
<li>Edit your <code>docker-compose.yml</code> according to the template below and comments.</li>
</ol>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">version</span><span class="p">:</span> <span class="s1">'3'</span>
<span class="n">services</span><span class="p">:</span>
        <span class="n">web</span><span class="p">:</span>
                <span class="n">image</span><span class="p">:</span> <span class="n">flask_port_v1</span> <span class="c1"># Change the image name to something unique to your project, aka my_unique_name_v1</span>
                <span class="n">build</span><span class="p">:</span> <span class="o">.</span>
                <span class="n">ports</span><span class="p">:</span>
                        <span class="o">-</span> <span class="s2">"8---:8080"</span> <span class="c1"># Edit the number on the left to match the port you selected</span>
                <span class="n">volumes</span><span class="p">:</span>
                        <span class="o">-</span> <span class="o">./</span><span class="n">volumes</span><span class="p">:</span><span class="o">/</span><span class="n">volumes</span>
                        <span class="o">-</span> <span class="o">./</span><span class="n">instance</span><span class="p">:</span><span class="o">/</span><span class="n">instance</span>
                <span class="n">restart</span><span class="p">:</span> <span class="n">unless</span><span class="o">-</span><span class="n">stopped</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ol>
<li>
<p>Test <code>docker-compose up</code> or <code>sudo docker-compose up</code> in your VSCode terminal (don't forget to 'cd' into the right repo.)  Errors will be shown in Terminal, be sure NOT to type -d.</p>
</li>
<li>
<p>After it's done building, type in <code>http://localhost:8---</code> in your browser (replace '8---' with your port number you've chosen)</p>
</li>
<li>
<p>If all runs smoothly, push your changes to Github and continue to <a href="https://nighthawkcoders.github.io/APCSP/deploymentGuide#AWS-Setup">AWS setup</a></p>
</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="AWS-Setup">
<a class="anchor" href="#AWS-Setup" aria-hidden="true"><span class="octicon octicon-link"></span></a>AWS Setup<a class="anchor-link" href="#AWS-Setup"> </a>
</h2>
<p>In the AWS EC2 terminal;</p>
<ol>
<li>
<p><code>cd ~</code></p>
</li>
<li>
<p>Clone your backend repo: <code>git clone github.com/server/project.git my_unique_name</code></p>
</li>
<li>
<p>Navigate to your repo: <code>cd my_unique_name</code></p>
</li>
<li>
<p>Build your site: <code>docker-compose up -d --build</code></p>
</li>
<li>
<p>Test your site: <code>curl localhost:8---</code> (replace '8---' with your port number)</p>
<blockquote>
<p>This should show you all the html content of your home page. If this provides 500 error you need to check your site on localhost.  If it produces broken pipe error you need to check your ports between docker-compose.yml and Docker files.  If the page does not have your content, you need to check <code>docker ps</code> as someone is using your port number.</p>
</blockquote>
</li>
</ol>
<p>If all runs smooth, continue to <a href="https://nighthawkcoders.github.io/APCSP/deploymentGuide#DNS-&amp;-NGINX-Setup">DNS &amp; NGINX Setup</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="DNS-&amp;-NGINX-Setup">
<a class="anchor" href="#DNS-&amp;-NGINX-Setup" aria-hidden="true"><span class="octicon octicon-link"></span></a>DNS &amp; NGINX Setup<a class="anchor-link" href="#DNS-&amp;-NGINX-Setup"> </a>
</h2>
<blockquote>
<p>Follow <a href="https://moonpiedumplings.github.io/quartotest/posts/duckdns/">Jeffrey's guide to duckdns</a> (Public IP can be found below the AWS terminal or by running <code>ifconfig.me</code>)</p>
</blockquote>
<h3 id="Nginx-setup-in-AWS-terminal">
<a class="anchor" href="#Nginx-setup-in-AWS-terminal" aria-hidden="true"><span class="octicon octicon-link"></span></a>Nginx setup in AWS terminal<a class="anchor-link" href="#Nginx-setup-in-AWS-terminal"> </a>
</h3>
<ol>
<li>
<p>Navigate to nginx: <code>cd /etc/nginx/sites-available</code></p>
</li>
<li>
<p>Create an nginx config file: <code>sudo nano myUniqueName</code></p>
</li>
<li>
<p>Use the format below to write into your config file, make updates according to comments</p>
</li>
</ol>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">server</span> <span class="p">{</span>
   <span class="n">listen</span> <span class="mi">80</span><span class="p">;</span>
    <span class="n">listen</span> <span class="p">[::]:</span><span class="mi">80</span><span class="p">;</span>
    <span class="n">server_name</span> <span class="o">-----.</span><span class="n">duckdns</span><span class="o">.</span><span class="n">org</span><span class="p">;</span> <span class="c1"># CHANGE SERVER NAME TO YOUR REGISTERED DOMAIN</span>
    <span class="n">location</span> <span class="o">/</span> <span class="p">{</span>
        <span class="n">proxy_pass</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8</span><span class="o">---</span><span class="p">;</span> <span class="c1"># CHANGE PORT TO YOUR UNIQUE PORT</span>
        <span class="c1"># Simple requests</span>
        <span class="k">if</span> <span class="p">(</span><span class="err">$</span><span class="n">request_method</span> <span class="o">~*</span> <span class="err">“</span><span class="p">(</span><span class="n">GET</span><span class="o">|</span><span class="n">POST</span><span class="o">|</span><span class="n">PUT</span><span class="o">|</span><span class="n">DELETE</span><span class="p">)</span><span class="err">“</span><span class="p">)</span> <span class="p">{</span> <span class="c1"># Customize Request methods based on your needs</span>
                <span class="n">add_header</span> <span class="err">“</span><span class="n">Access</span><span class="o">-</span><span class="n">Control</span><span class="o">-</span><span class="n">Allow</span><span class="o">-</span><span class="n">Origin</span><span class="err">”</span>  <span class="o">*</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="c1"># Preflighted requests</span>
        <span class="k">if</span> <span class="p">(</span><span class="err">$</span><span class="n">request_method</span> <span class="o">=</span> <span class="n">OPTIONS</span> <span class="p">)</span> <span class="p">{</span>
                <span class="n">add_header</span> <span class="err">“</span><span class="n">Access</span><span class="o">-</span><span class="n">Control</span><span class="o">-</span><span class="n">Allow</span><span class="o">-</span><span class="n">Origin</span><span class="err">”</span>  <span class="o">*</span><span class="p">;</span>
                <span class="n">add_header</span> <span class="err">“</span><span class="n">Access</span><span class="o">-</span><span class="n">Control</span><span class="o">-</span><span class="n">Allow</span><span class="o">-</span><span class="n">Methods</span><span class="err">”</span> <span class="err">“</span><span class="n">GET</span><span class="p">,</span> <span class="n">POST</span><span class="p">,</span> <span class="n">PUT</span><span class="p">,</span> <span class="n">DELETE</span><span class="p">,</span> <span class="n">OPTIONS</span><span class="p">,</span> <span class="n">HEAD</span><span class="err">”</span><span class="p">;</span> <span class="c1"># Make sure the request methods above match here</span>
                <span class="n">add_header</span> <span class="err">“</span><span class="n">Access</span><span class="o">-</span><span class="n">Control</span><span class="o">-</span><span class="n">Allow</span><span class="o">-</span><span class="n">Headers</span><span class="err">”</span> <span class="err">“</span><span class="n">Authorization</span><span class="p">,</span> <span class="n">Origin</span><span class="p">,</span> <span class="n">X</span><span class="o">-</span><span class="n">Requested</span><span class="o">-</span><span class="n">With</span><span class="p">,</span> <span class="n">Content</span><span class="o">-</span><span class="n">Type</span><span class="p">,</span> <span class="n">Accept</span><span class="err">”</span><span class="p">;</span>
                <span class="k">return</span> <span class="mi">200</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ol>
<li>
<p>To save changes, <code>ctl X</code> or <code>cmd X</code>, then <code>y</code>, then <code>enter</code></p>
</li>
<li>
<p>Create a symbolic link: <code>cd /etc/nginx/sites-enabled</code>, then <code>sudo ln -s /etc/nginx/sites-available/myUniqueName /etc/nginx/sites-enabled</code> (change myUniqueName to your nginx config file name)</p>
</li>
<li>
<p>Validate by running: <code>sudo nginx -t</code></p>
</li>
<li>
<p>Restart nginx by running <code>sudo systemctl restart nginx</code></p>
</li>
<li>
<p>Test your domain name on your desktop browser now (only http://, not https://)</p>
</li>
</ol>
<p>If all runs smoothly, continue to <a href="https://nighthawkcoders.github.io/APCSP/deploymentGuide#Certbot-Config">Certbot config</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Certbot-Config">
<a class="anchor" href="#Certbot-Config" aria-hidden="true"><span class="octicon octicon-link"></span></a>Certbot Config<a class="anchor-link" href="#Certbot-Config"> </a>
</h2>
<blockquote>
<p>Certbot allows your site to get a certificate in order for the http request to be secure (https)</p>
</blockquote>
<ul>
<li>Run command below and follow prompts</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sudo</span> <span class="n">certbot</span> <span class="o">--</span><span class="n">nginx</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Ideal outcome is shown below</strong></p>
<ul>
<li>There are two outcomes during Certbot<ul>
<li>Success, test your domain name on your desktop browser now using https://</li>
<li>Failure, follow guidance provided by CertBot</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Saving</span> <span class="n">debug</span> <span class="n">log</span> <span class="n">to</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">letsencrypt</span><span class="o">/</span><span class="n">letsencrypt</span><span class="o">.</span><span class="n">log</span>
<span class="n">Plugins</span> <span class="n">selected</span><span class="p">:</span> <span class="n">Authenticator</span> <span class="n">nginx</span><span class="p">,</span> <span class="n">Installer</span> <span class="n">nginx</span>

<span class="n">Which</span> <span class="n">names</span> <span class="n">would</span> <span class="n">you</span> <span class="n">like</span> <span class="n">to</span> <span class="n">activate</span> <span class="n">HTTPS</span> for<span class="o">?</span>
<span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span>
<span class="mi">1</span><span class="p">:</span> <span class="n">coolcodersjava</span><span class="o">.</span><span class="n">pw</span>
<span class="mi">2</span><span class="p">:</span> <span class="n">www</span><span class="o">.</span><span class="n">coolcodersjava</span><span class="o">.</span><span class="n">pw</span>
<span class="mi">3</span><span class="p">:</span> <span class="n">ajarcade</span><span class="o">.</span><span class="n">duckdns</span><span class="o">.</span><span class="n">org</span>
<span class="mi">4</span><span class="p">:</span> <span class="n">flowhealth</span><span class="o">.</span><span class="n">duckdns</span><span class="o">.</span><span class="n">org</span>
<span class="mi">5</span><span class="p">:</span> <span class="n">goatedgroup</span><span class="o">.</span><span class="n">duckdns</span><span class="o">.</span><span class="n">org</span>
<span class="mi">6</span><span class="p">:</span> <span class="n">jasj</span><span class="o">-</span><span class="n">inventory</span><span class="o">.</span><span class="n">duckdns</span><span class="o">.</span><span class="n">org</span>
<span class="mi">7</span><span class="p">:</span> <span class="n">recipies</span><span class="o">.</span><span class="n">duckdns</span><span class="o">.</span><span class="n">org</span>
<span class="mi">8</span><span class="p">:</span> <span class="n">ssvgcars</span><span class="o">.</span><span class="n">duckdns</span><span class="o">.</span><span class="n">org</span>
<span class="mi">9</span><span class="p">:</span> <span class="n">userapi</span><span class="o">.</span><span class="n">duckdns</span><span class="o">.</span><span class="n">org</span>
<span class="mi">10</span><span class="p">:</span> <span class="n">fr0st</span><span class="o">.</span><span class="n">ml</span>
<span class="mi">11</span><span class="p">:</span> <span class="n">www</span><span class="o">.</span><span class="n">fr0st</span><span class="o">.</span><span class="n">ml</span>
<span class="mi">12</span><span class="p">:</span> <span class="n">agenda</span><span class="o">.</span><span class="n">nighthawkcodescrums</span><span class="o">.</span><span class="n">gq</span>
<span class="mi">13</span><span class="p">:</span> <span class="n">coolcoders</span><span class="o">.</span><span class="n">nighthawkcodescrums</span><span class="o">.</span><span class="n">gq</span>
<span class="mi">14</span><span class="p">:</span> <span class="n">escaperoom</span><span class="o">.</span><span class="n">nighthawkcodescrums</span><span class="o">.</span><span class="n">gq</span>
<span class="mi">15</span><span class="p">:</span> <span class="n">frost</span><span class="o">.</span><span class="n">nighthawkcodescrums</span><span class="o">.</span><span class="n">gq</span>
<span class="mi">16</span><span class="p">:</span> <span class="n">jame</span><span class="o">.</span><span class="n">nighthawkcodescrums</span><span class="o">.</span><span class="n">gq</span>
<span class="mi">17</span><span class="p">:</span> <span class="n">lawnmowers</span><span class="o">.</span><span class="n">nighthawkcodescrums</span><span class="o">.</span><span class="n">gq</span>
<span class="mi">18</span><span class="p">:</span> <span class="n">loopholegames</span><span class="o">.</span><span class="n">nighthawkcodescrums</span><span class="o">.</span><span class="n">gq</span>
<span class="mi">19</span><span class="p">:</span> <span class="n">musicmania</span><span class="o">.</span><span class="n">nighthawkcodescrums</span><span class="o">.</span><span class="n">gq</span>
<span class="mi">20</span><span class="p">:</span> <span class="n">nba</span><span class="o">.</span><span class="n">nighthawkcodescrums</span><span class="o">.</span><span class="n">gq</span>
<span class="mi">21</span><span class="p">:</span> <span class="n">sadv</span><span class="o">.</span><span class="n">nighthawkcodescrums</span><span class="o">.</span><span class="n">gq</span>
<span class="mi">22</span><span class="p">:</span> <span class="n">ssjn</span><span class="o">.</span><span class="n">nighthawkcodescrums</span><span class="o">.</span><span class="n">gq</span>
<span class="mi">23</span><span class="p">:</span> <span class="n">stocks</span><span class="o">.</span><span class="n">nighthawkcodescrums</span><span class="o">.</span><span class="n">gq</span>
<span class="mi">24</span><span class="p">:</span> <span class="n">striver</span><span class="o">.</span><span class="n">nighthawkcodescrums</span><span class="o">.</span><span class="n">gq</span>
<span class="mi">25</span><span class="p">:</span> <span class="n">tngc</span><span class="o">.</span><span class="n">nighthawkcodescrums</span><span class="o">.</span><span class="n">gq</span>
<span class="mi">26</span><span class="p">:</span> <span class="n">white</span><span class="o">.</span><span class="n">nighthawkcodescrums</span><span class="o">.</span><span class="n">gq</span>
<span class="mi">27</span><span class="p">:</span> <span class="n">workwatch</span><span class="o">.</span><span class="n">nighthawkcodescrums</span><span class="o">.</span><span class="n">gq</span>
<span class="mi">28</span><span class="p">:</span> <span class="n">cars</span><span class="o">.</span><span class="n">nighthawkcodingsociety</span><span class="o">.</span><span class="n">com</span>
<span class="mi">29</span><span class="p">:</span> <span class="n">dolphin</span><span class="o">.</span><span class="n">nighthawkcodingsociety</span><span class="o">.</span><span class="n">com</span>
<span class="mi">30</span><span class="p">:</span> <span class="n">saakd</span><span class="o">.</span><span class="n">nighthawkcodingsociety</span><span class="o">.</span><span class="n">com</span>
<span class="mi">31</span><span class="p">:</span> <span class="n">pythonalflask</span><span class="o">.</span><span class="n">tk</span>
<span class="mi">32</span><span class="p">:</span> <span class="n">www</span><span class="o">.</span><span class="n">pythonalflask</span><span class="o">.</span><span class="n">tk</span>
<span class="mi">33</span><span class="p">:</span> <span class="n">teambrobro</span><span class="o">.</span><span class="n">tk</span>
<span class="mi">34</span><span class="p">:</span> <span class="n">www</span><span class="o">.</span><span class="n">teambrobro</span><span class="o">.</span><span class="n">tk</span>
<span class="mi">35</span><span class="p">:</span> <span class="n">teamcheeseatimetime</span><span class="o">.</span><span class="n">tk</span>
<span class="mi">36</span><span class="p">:</span> <span class="n">www</span><span class="o">.</span><span class="n">teamcheeseatimetime</span><span class="o">.</span><span class="n">tk</span>
<span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span>
<span class="n">Select</span> <span class="n">the</span> <span class="n">appropriate</span> <span class="n">numbers</span> <span class="n">separated</span> <span class="n">by</span> <span class="n">commas</span> <span class="ow">and</span><span class="o">/</span><span class="ow">or</span> <span class="n">spaces</span><span class="p">,</span> <span class="ow">or</span> <span class="n">leave</span> <span class="nb">input</span>
<span class="n">blank</span> <span class="n">to</span> <span class="n">select</span> <span class="nb">all</span> <span class="n">options</span> <span class="n">shown</span> <span class="p">(</span><span class="n">Enter</span> <span class="s1">'c'</span> <span class="n">to</span> <span class="n">cancel</span><span class="p">):</span> <span class="c1"># ENTER YOUR CORRESPONDING NUMBER</span>

<span class="n">Cert</span> <span class="ow">not</span> <span class="n">yet</span> <span class="n">due</span> <span class="k">for</span> <span class="n">renewal</span>

<span class="n">You</span> <span class="n">have</span> <span class="n">an</span> <span class="n">existing</span> <span class="n">certificate</span> <span class="n">that</span> <span class="n">has</span> <span class="n">exactly</span> <span class="n">the</span> <span class="n">same</span> <span class="n">domains</span> <span class="ow">or</span> <span class="n">certificate</span> <span class="n">name</span> <span class="n">you</span> <span class="n">requested</span> <span class="ow">and</span> <span class="n">isn</span><span class="s1">'t close to expiry.</span>
<span class="p">(</span><span class="n">ref</span><span class="p">:</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">letsencrypt</span><span class="o">/</span><span class="n">renewal</span><span class="o">/</span><span class="n">nighthawkcodingsociety</span><span class="o">.</span><span class="n">com</span><span class="o">-</span><span class="mf">0001.</span><span class="n">conf</span><span class="p">)</span>

<span class="n">What</span> <span class="n">would</span> <span class="n">you</span> <span class="n">like</span> <span class="n">to</span> do<span class="o">?</span>
<span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span>
<span class="mi">1</span><span class="p">:</span> <span class="n">Attempt</span> <span class="n">to</span> <span class="n">reinstall</span> <span class="n">this</span> <span class="n">existing</span> <span class="n">certificate</span>
<span class="mi">2</span><span class="p">:</span> <span class="n">Renew</span> <span class="o">&amp;</span> <span class="n">replace</span> <span class="n">the</span> <span class="n">cert</span> <span class="p">(</span><span class="n">limit</span> <span class="o">~</span><span class="mi">5</span> <span class="n">per</span> <span class="mi">7</span> <span class="n">days</span><span class="p">)</span>
<span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span>
<span class="n">Select</span> <span class="n">the</span> <span class="n">appropriate</span> <span class="n">number</span> <span class="p">[</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="n">then</span> <span class="p">[</span><span class="n">enter</span><span class="p">]</span> <span class="p">(</span><span class="n">press</span> <span class="s1">'c'</span> <span class="n">to</span> <span class="n">cancel</span><span class="p">):</span> <span class="mi">2</span>
<span class="n">Renewing</span> <span class="n">an</span> <span class="n">existing</span> <span class="n">certificate</span>
<span class="n">Performing</span> <span class="n">the</span> <span class="n">following</span> <span class="n">challenges</span><span class="p">:</span>
<span class="n">http</span><span class="o">-</span><span class="mi">01</span> <span class="n">challenge</span> <span class="k">for</span> <span class="n">nighthawkcodingsociety</span><span class="o">.</span><span class="n">com</span>
<span class="n">http</span><span class="o">-</span><span class="mi">01</span> <span class="n">challenge</span> <span class="k">for</span> <span class="n">csa</span><span class="o">.</span><span class="n">nighthawkcodingsociety</span><span class="o">.</span><span class="n">com</span>
<span class="n">http</span><span class="o">-</span><span class="mi">01</span> <span class="n">challenge</span> <span class="k">for</span> <span class="n">cso</span><span class="o">.</span><span class="n">nighthawkcodingsociety</span><span class="o">.</span><span class="n">com</span>
<span class="n">http</span><span class="o">-</span><span class="mi">01</span> <span class="n">challenge</span> <span class="k">for</span> <span class="n">flm</span><span class="o">.</span><span class="n">nighthawkcodingsociety</span><span class="o">.</span><span class="n">com</span>
<span class="n">Waiting</span> <span class="k">for</span> <span class="n">verification</span><span class="o">...</span>
<span class="n">Cleaning</span> <span class="n">up</span> <span class="n">challenges</span>
<span class="n">Deploying</span> <span class="n">Certificate</span> <span class="n">to</span> <span class="n">VirtualHost</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">sites</span><span class="o">-</span><span class="n">enabled</span><span class="o">/</span><span class="n">nighthawk_society</span>
<span class="n">Deploying</span> <span class="n">Certificate</span> <span class="n">to</span> <span class="n">VirtualHost</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">sites</span><span class="o">-</span><span class="n">enabled</span><span class="o">/</span><span class="n">nighthawk_csa</span>
<span class="n">Deploying</span> <span class="n">Certificate</span> <span class="n">to</span> <span class="n">VirtualHost</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">sites</span><span class="o">-</span><span class="n">enabled</span><span class="o">/</span><span class="n">nighthawk_csp</span>
<span class="n">Deploying</span> <span class="n">Certificate</span> <span class="n">to</span> <span class="n">VirtualHost</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">sites</span><span class="o">-</span><span class="n">enabled</span><span class="o">/</span><span class="n">nighthawk_flm</span>

<span class="n">Please</span> <span class="n">choose</span> <span class="n">whether</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">to</span> <span class="n">redirect</span> <span class="n">HTTP</span> <span class="n">traffic</span> <span class="n">to</span> <span class="n">HTTPS</span><span class="p">,</span> <span class="n">removing</span> <span class="n">HTTP</span> <span class="n">access</span><span class="o">.</span>
<span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span>
<span class="mi">1</span><span class="p">:</span> <span class="n">No</span> <span class="n">redirect</span> <span class="o">-</span> <span class="n">Make</span> <span class="n">no</span> <span class="n">further</span> <span class="n">changes</span> <span class="n">to</span> <span class="n">the</span> <span class="n">webserver</span> <span class="n">configuration</span><span class="o">.</span>
<span class="mi">2</span><span class="p">:</span> <span class="n">Redirect</span> <span class="o">-</span> <span class="n">Make</span> <span class="nb">all</span> <span class="n">requests</span> <span class="n">redirect</span> <span class="n">to</span> <span class="n">secure</span> <span class="n">HTTPS</span> <span class="n">access</span><span class="o">.</span> <span class="n">Choose</span> <span class="n">this</span> <span class="k">for</span>
<span class="n">new</span> <span class="n">sites</span><span class="p">,</span> <span class="ow">or</span> <span class="k">if</span> <span class="n">you</span><span class="s1">'re confident your site works on HTTPS. You can undo this</span>
<span class="n">change</span> <span class="n">by</span> <span class="n">editing</span> <span class="n">your</span> <span class="n">web</span> <span class="n">server</span><span class="s1">'s configuration.</span>
<span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span>
<span class="n">Select</span> <span class="n">the</span> <span class="n">appropriate</span> <span class="n">number</span> <span class="p">[</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="n">then</span> <span class="p">[</span><span class="n">enter</span><span class="p">]</span> <span class="p">(</span><span class="n">press</span> <span class="s1">'c'</span> <span class="n">to</span> <span class="n">cancel</span><span class="p">):</span> <span class="mi">2</span>
<span class="n">Traffic</span> <span class="n">on</span> <span class="n">port</span> <span class="mi">80</span> <span class="n">already</span> <span class="n">redirecting</span> <span class="n">to</span> <span class="n">ssl</span> <span class="ow">in</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">sites</span><span class="o">-</span><span class="n">enabled</span><span class="o">/</span><span class="n">nighthawk_society</span>
<span class="n">Traffic</span> <span class="n">on</span> <span class="n">port</span> <span class="mi">80</span> <span class="n">already</span> <span class="n">redirecting</span> <span class="n">to</span> <span class="n">ssl</span> <span class="ow">in</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">sites</span><span class="o">-</span><span class="n">enabled</span><span class="o">/</span><span class="n">nighthawk_csa</span>
<span class="n">Traffic</span> <span class="n">on</span> <span class="n">port</span> <span class="mi">80</span> <span class="n">already</span> <span class="n">redirecting</span> <span class="n">to</span> <span class="n">ssl</span> <span class="ow">in</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">sites</span><span class="o">-</span><span class="n">enabled</span><span class="o">/</span><span class="n">nighthawk_csp</span>
<span class="n">Traffic</span> <span class="n">on</span> <span class="n">port</span> <span class="mi">80</span> <span class="n">already</span> <span class="n">redirecting</span> <span class="n">to</span> <span class="n">ssl</span> <span class="ow">in</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">sites</span><span class="o">-</span><span class="n">enabled</span><span class="o">/</span><span class="n">nighthawk_flm</span>

<span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span>
<span class="n">Your</span> <span class="n">existing</span> <span class="n">certificate</span> <span class="n">has</span> <span class="n">been</span> <span class="n">successfully</span> <span class="n">renewed</span><span class="p">,</span> <span class="ow">and</span> <span class="n">the</span> <span class="n">new</span> <span class="n">certificate</span>
<span class="n">has</span> <span class="n">been</span> <span class="n">installed</span><span class="o">.</span>

<span class="n">The</span> <span class="n">new</span> <span class="n">certificate</span> <span class="n">covers</span> <span class="n">the</span> <span class="n">following</span> <span class="n">domains</span><span class="p">:</span>
<span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nighthawkcodingsociety</span><span class="o">.</span><span class="n">com</span><span class="p">,</span> 
<span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">csa</span><span class="o">.</span><span class="n">nighthawkcodingsociety</span><span class="o">.</span><span class="n">com</span><span class="p">,</span> 
<span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">csp</span><span class="o">.</span><span class="n">nighthawkcodingsociety</span><span class="o">.</span><span class="n">com</span><span class="p">,</span> <span class="ow">and</span>
<span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">flm</span><span class="o">.</span><span class="n">nighthawkcodingsociety</span><span class="o">.</span><span class="n">com</span><span class="p">,</span>

<span class="n">You</span> <span class="n">should</span> <span class="n">test</span> <span class="n">your</span> <span class="n">configuration</span> <span class="n">at</span><span class="p">:</span>
<span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">ssllabs</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">ssltest</span><span class="o">/</span><span class="n">analyze</span><span class="o">.</span><span class="n">html</span><span class="err">?</span><span class="n">d</span><span class="o">=</span><span class="n">nighthawkcodingsociety</span><span class="o">.</span><span class="n">com</span>
<span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">ssllabs</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">ssltest</span><span class="o">/</span><span class="n">analyze</span><span class="o">.</span><span class="n">html</span><span class="err">?</span><span class="n">d</span><span class="o">=</span><span class="n">csa</span><span class="o">.</span><span class="n">nighthawkcodingsociety</span><span class="o">.</span><span class="n">com</span>
<span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">ssllabs</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">ssltest</span><span class="o">/</span><span class="n">analyze</span><span class="o">.</span><span class="n">html</span><span class="err">?</span><span class="n">d</span><span class="o">=</span><span class="n">csp</span><span class="o">.</span><span class="n">nighthawkcodingsociety</span><span class="o">.</span><span class="n">com</span>
<span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">ssllabs</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">ssltest</span><span class="o">/</span><span class="n">analyze</span><span class="o">.</span><span class="n">html</span><span class="err">?</span><span class="n">d</span><span class="o">=</span><span class="n">flm</span><span class="o">.</span><span class="n">nighthawkcodingsociety</span><span class="o">.</span><span class="n">com</span>
<span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span>

<span class="n">IMPORTANT</span> <span class="n">NOTES</span><span class="p">:</span>
 <span class="o">-</span> <span class="n">Congratulations</span><span class="o">!</span> Your certificate and chain have been saved at:
   <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">letsencrypt</span><span class="o">/</span><span class="n">live</span><span class="o">/</span><span class="n">nighthawkcodingsociety</span><span class="o">.</span><span class="n">com</span><span class="o">-</span><span class="mi">0001</span><span class="o">/</span><span class="n">fullchain</span><span class="o">.</span><span class="n">pem</span>
   <span class="n">Your</span> <span class="n">key</span> <span class="n">file</span> <span class="n">has</span> <span class="n">been</span> <span class="n">saved</span> <span class="n">at</span><span class="p">:</span>
   <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">letsencrypt</span><span class="o">/</span><span class="n">live</span><span class="o">/</span><span class="n">nighthawkcodingsociety</span><span class="o">.</span><span class="n">com</span><span class="o">-</span><span class="mi">0001</span><span class="o">/</span><span class="n">privkey</span><span class="o">.</span><span class="n">pem</span>
   <span class="n">Your</span> <span class="n">cert</span> <span class="n">will</span> <span class="n">expire</span> <span class="n">on</span> <span class="mi">2022</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mf">06.</span> <span class="n">To</span> <span class="n">obtain</span> <span class="n">a</span> <span class="n">new</span> <span class="ow">or</span> <span class="n">tweaked</span>
   <span class="n">version</span> <span class="n">of</span> <span class="n">this</span> <span class="n">certificate</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">future</span><span class="p">,</span> <span class="n">simply</span> <span class="n">run</span> <span class="n">certbot</span> <span class="n">again</span>
   <span class="k">with</span> <span class="n">the</span> <span class="s2">"certonly"</span> <span class="n">option</span><span class="o">.</span> <span class="n">To</span> <span class="n">non</span><span class="o">-</span><span class="n">interactively</span> <span class="n">renew</span> <span class="o">*</span><span class="nb">all</span><span class="o">*</span> <span class="n">of</span>
   <span class="n">your</span> <span class="n">certificates</span><span class="p">,</span> <span class="n">run</span> <span class="s2">"certbot renew"</span>
 <span class="o">-</span> <span class="n">If</span> <span class="n">you</span> <span class="n">like</span> <span class="n">Certbot</span><span class="p">,</span> <span class="n">please</span> <span class="n">consider</span> <span class="n">supporting</span> <span class="n">our</span> <span class="n">work</span> <span class="n">by</span><span class="p">:</span>

   <span class="n">Donating</span> <span class="n">to</span> <span class="n">ISRG</span> <span class="o">/</span> <span class="n">Let</span><span class="s1">'s Encrypt:   https://letsencrypt.org/donate</span>
   <span class="n">Donating</span> <span class="n">to</span> <span class="n">EFF</span><span class="p">:</span>                    <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">eff</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">donate</span><span class="o">-</span><span class="n">le</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Changing-Code-will-require-Deployment-Updates">
<a class="anchor" href="#Changing-Code-will-require-Deployment-Updates" aria-hidden="true"><span class="octicon octicon-link"></span></a>Changing Code will require Deployment Updates<a class="anchor-link" href="#Changing-Code-will-require-Deployment-Updates"> </a>
</h2>
<h3 id="Changing-Code-in-VSCode">
<a class="anchor" href="#Changing-Code-in-VSCode" aria-hidden="true"><span class="octicon octicon-link"></span></a>Changing Code in VSCode<a class="anchor-link" href="#Changing-Code-in-VSCode"> </a>
</h3>
<blockquote>
<p>To keep deployment working, good practices in your coding process with verifications prior to pushing code to GitHub will save a lot of troubleshooting.</p>
</blockquote>
<ol>
<li>
<p>Make sure to <code>git pull</code> before making changes</p>
<blockquote>
<p>This will make sure that you pull any changes made by your team, and prevents merge conflicts</p>
</blockquote>
</li>
<li>
<p>Open terminal in VSCode and run <code>python3 main.py</code> (Make sure you cd into your repo)</p>
<blockquote>
<p>This should give you a local address where your flask is running. Open this in your browser to see your changes live</p>
</blockquote>
</li>
<li>
<p>Make changes that are needed</p>
<blockquote>
<p>Refer to your running site often to see changes as you develop</p>
</blockquote>
</li>
<li>
<p>Commit your changes locally</p>
<blockquote>
<p>Do not <code>Sync</code> change from UI or <code>git push</code> from terminal yet, just <code>Commit</code>.  It is great practice to <strong><em>Commit Often</em></strong> with sensible comments.  Anytime after you commit you can pull team members changes for additional verifications.</p>
</blockquote>
</li>
<li>
<p>Before updating deployment start <strong><em>Docker Desktop app</em></strong>  and test your Web Application.</p>
<blockquote>
<p>Test <code>docker-compose up</code> or <code>sudo docker-compose up</code> in your VSCode terminal (don't forget to 'cd' into the right repo).</p>
</blockquote>
</li>
<li>
<p>After Docker is done building, type in <code>http://localhost:8---</code> in your browser.&gt; Replace '8---' with your port number. Review your personal changes and team members changes in running site. As long as Docker Desktop and Docker App is running, you can make little changes and save, they should refresh in site within a few seconds.  <strong><em>Any errors, runtime errors, will appear in browser of VSCode terminal</em></strong>, read messages thoroughly and debug errors.  Docker Desktop may consume a lot of CPU resources, if you are unplugged you may want to close it after you are done testing.</p>
</li>
<li>
<p>If all goes well, <code>Sync</code> change from UI or <code>git push</code> from terminal.</p>
<blockquote>
<p>If you can't push review <code>git status</code> from terminal.   Resolve all open files <code>git restore</code> or <code>git commit</code>, then <code>git pull</code> and repeat steps 5 to 7.</p>
</blockquote>
</li>
</ol>
<h3 id="Pulling-Changes-into-AWS-EC2-deployment">
<a class="anchor" href="#Pulling-Changes-into-AWS-EC2-deployment" aria-hidden="true"><span class="octicon octicon-link"></span></a>Pulling Changes into AWS EC2 deployment<a class="anchor-link" href="#Pulling-Changes-into-AWS-EC2-deployment"> </a>
</h3>
<blockquote>
<p>Updates should be quick and easy, as long as your teams verifies problems on localhost prior to these steps.</p>
</blockquote>
<p>In your AWS EC2 terminal;</p>
<ol>
<li>Navigate to your repo:<code>cd ~/my_unique_name</code>
</li>
<li>
<code>docker-compose down</code><blockquote>
<p>Test Server in browser using https://, it should be down (502 Bad Gateway in browser)</p>
</blockquote>
</li>
<li>
<p><code>git pull</code></p>
</li>
<li>
<p>Rebuild your docker container: <code>docker-compose up -d --build</code></p>
<blockquote>
<p>Test Server in browser using https://, sll updates should be up and running on internet.</p>
</blockquote>
</li>
</ol>
<h3 id="Optional,-Troubleshooting-checks-on-AWS-EC2">
<a class="anchor" href="#Optional,-Troubleshooting-checks-on-AWS-EC2" aria-hidden="true"><span class="octicon octicon-link"></span></a>Optional, Troubleshooting checks on AWS EC2<a class="anchor-link" href="#Optional,-Troubleshooting-checks-on-AWS-EC2"> </a>
</h3>
<blockquote>
<p>These commands let you see status of your running web application on AWS EC2</p>
</blockquote>
<ol>
<li>
<p>Try to curl:<code>curl localhost:8---</code> (replace '8---' with your port number)&gt; Verify home pages is yours</p>
</li>
<li>
<p>Run <code>docker-compose ps</code></p>
<blockquote>
<p>Perform check on your container, verify docker is up</p>
</blockquote>
</li>
<li>
<p>Run <code>docker ps</code></p>
<blockquote>
<p>Perform checks on all containers and all images</p>
</blockquote>
</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Congratulations!">
<a class="anchor" href="#Congratulations!" aria-hidden="true"><span class="octicon octicon-link"></span></a>Congratulations!<a class="anchor-link" href="#Congratulations!"> </a>
</h2>
<p>Congratulations on deploying your site with AWS! A special thanks to Azeem Khan, Samit Poojary, Ethan Tran, Sophie Park, Edwin Abraham, Mr. Mortensen and Jeffrey Fonseca for helping put this together.</p>

</div>
</div>
</div>
</div>



  </div><a class="u-url" href="/APCSP/deploymentGuide" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/APCSP/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="https://nighthawkcoders.github.io/APCSP/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/APCSP/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>AP Computer Science Principles course materials.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li>
  <a rel="me" href="https://github.com/nighthawkcoders" target="_blank" title="github">
    <svg class="svg-icon grey">
      <use xlink:href="/APCSP/assets/minima-social-icons.svg#github"></use>
    </svg>
  </a>
</li>
<li>
  <a rel="me" href="https://twitter.com/NighthawkCoding" target="_blank" title="twitter">
    <svg class="svg-icon grey">
      <use xlink:href="/APCSP/assets/minima-social-icons.svg#twitter"></use>
    </svg>
  </a>
</li>
<li>
  <a rel="me" href="https://www.youtube.com/channel/UClIKOsDS5dsfzFA3zveDT3Q" target="_blank" title="youtube">
    <svg class="svg-icon grey">
      <use xlink:href="/APCSP/assets/minima-social-icons.svg#youtube"></use>
    </svg>
  </a>
</li>
</ul>
</div>

  </div>

</footer>
</body>

</html>
